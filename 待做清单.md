# 待做清单

## 🔴 高优先级（P0 - 必须实现）

### 1. 安全与权限模块 (FR-SA-006) - 部分完成 ✅
- [x] **RBAC权限模型** ✅
  - [x] 角色定义和管理
  - [x] 权限分配和继承
  - [x] 权限检查中间件
  - [ ] 权限缓存机制（性能优化）
  - [ ] 权限变更通知机制
  
- [x] **操作审计日志** ✅
  - [x] 操作记录（谁、何时、做了什么）
  - [x] 审计日志存储和查询
  - [ ] 日志防篡改机制
  - [ ] 日志文件轮转机制

- [ ] **API访问控制**
  - [ ] 基于角色的API访问限制
  - [ ] API调用频率限制
  - [ ] API密钥管理

- [ ] **会话管理**
  - [ ] 用户会话创建和销毁
  - [ ] 会话超时处理
  - [ ] 会话状态管理

### 2. 高可用和容错 (FR-HA-007) - 部分完成 ✅
- [x] **服务熔断和超时控制** ✅（第一阶段完成）
- [ ] **重试策略**
  - [ ] 指数退避重试
  - [ ] 最大重试次数配置
  - [ ] 重试条件判断

- [ ] **降级方案**
  - [ ] 服务降级策略定义
  - [ ] 降级服务实现
  - [ ] 自动降级触发机制

- [ ] **故障转移**
  - [ ] 主备服务切换
  - [ ] 状态同步机制
  - [ ] 快速故障检测

- [ ] **备份和恢复**
  - [ ] 配置自动备份
  - [ ] 数据备份策略
  - [ ] 版本回滚功能

## 🟡 中优先级（P1 - 重要功能）

### 3. 开发工具链 (FR-DT-004)
- [ ] **CLI工具（eagle-cli）**
  - [ ] 项目创建命令
  - [ ] 插件生成命令
  - [ ] 配置管理命令
  - [ ] 调试命令

- [ ] **项目模板生成器**
  - [ ] UI插件模板
  - [ ] 服务插件模板
  - [ ] 工具插件模板

- [ ] **调试工具**
  - [ ] 插件热重载
  - [ ] 内存泄漏检测集成
  - [ ] 性能分析工具集成

- [ ] **测试框架集成**
  - [ ] 单元测试模板
  - [ ] 集成测试支持
  - [ ] 性能测试工具

### 4. 监控和诊断 (FR-MD-005)
- [ ] **实时性能监控**
  - [ ] CPU使用率监控
  - [ ] 内存使用率监控
  - [ ] 插件加载时间统计
  - [ ] 服务响应时间统计

- [ ] **错误追踪和告警**
  - [ ] 错误聚合和分析
  - [ ] 告警规则配置
  - [ ] 告警通知（邮件、短信等）

- [ ] **诊断工具**
  - [ ] 堆栈跟踪分析
  - [ ] 内存快照功能
  - [ ] 死锁检测
  - [ ] 网络抓包工具

- [ ] **健康检查**
  - [ ] 系统健康检查接口
  - [ ] 插件健康检查
  - [ ] 服务健康检查聚合

### 5. REST API接口
- [ ] **插件管理API**
  - [ ] GET /api/v1/plugins - 获取插件列表
  - [ ] GET /api/v1/plugins/{id} - 获取插件详情
  - [ ] POST /api/v1/plugins/{id}/load - 加载插件
  - [ ] DELETE /api/v1/plugins/{id} - 卸载插件

- [ ] **系统管理API**
  - [ ] GET /api/v1/health - 健康检查
  - [ ] GET /api/v1/metrics - 监控指标
  - [ ] GET /api/v1/logs - 日志查询
  - [ ] POST /api/v1/config - 配置更新

- [ ] **HTTP服务器**
  - [ ] 基于Qt的HTTP服务器实现
  - [ ] 路由管理
  - [ ] 请求/响应处理
  - [ ] 认证中间件

## 🟢 低优先级（P2 - 增强功能）

### 6. 插件管理系统增强
- [ ] **插件分类管理**
  - [ ] UI插件、服务插件、工具插件分类
  - [ ] 按分类筛选和显示

- [ ] **循环依赖检测和告警**
  - [ ] 依赖图构建
  - [ ] 循环检测算法
  - [ ] 告警机制

- [ ] **版本冲突自动解决**
  - [ ] 版本语义化解析
  - [ ] 冲突检测
  - [ ] 自动解决策略

- [ ] **插件沙箱运行模式**
  - [ ] 进程隔离
  - [ ] 资源限制强制执行
  - [ ] 文件系统隔离
  - [ ] 网络隔离

### 7. 服务总线系统增强
- [ ] **异步服务调用**
  - [ ] 异步调用接口
  - [ ] Future/Promise模式
  - [ ] 回调机制

- [ ] **远程服务通信**
  - [ ] HTTP服务调用
  - [ ] gRPC服务调用
  - [ ] 服务发现（Consul等）

- [ ] **负载均衡**
  - [ ] 轮询算法
  - [ ] 加权轮询
  - [ ] 最少连接数

### 8. 配置管理系统增强
- [ ] **配置版本管理**
  - [ ] 配置版本号
  - [ ] 版本历史记录
  - [ ] 版本回滚

- [ ] **远程配置中心**
  - [ ] 配置中心客户端
  - [ ] 配置拉取和推送
  - [ ] 配置变更通知

- [ ] **YAML/INI格式支持**
  - [ ] YAML解析器集成
  - [ ] INI文件解析
  - [ ] 格式自动识别

- [ ] **Schema验证**
  - [ ] JSON Schema支持
  - [ ] 类型检查
  - [ ] 依赖检查

### 9. 加密和安全增强
- [ ] **升级加密算法**
  - [ ] AES-256加密实现
  - [ ] 标准PBKDF2密钥派生
  - [ ] 密钥轮换机制

- [ ] **插件签名增强**
  - [ ] RSA非对称加密签名
  - [ ] 证书链验证
  - [ ] 签名撤销列表（CRL）

- [ ] **SSL/TLS支持**
  - [ ] HTTPS通信
  - [ ] 证书管理
  - [ ] TLS配置

### 10. 异常隔离增强
- [ ] **资源监控实现**
  - [ ] 实际内存使用监控
  - [ ] CPU使用率监控
  - [ ] 资源限制强制执行

- [ ] **进程隔离**
  - [ ] 插件进程分离
  - [ ] 进程间通信（IPC）
  - [ ] 进程监控和重启

## 📊 功能完成度

### 第一阶段（已完成）✅
- ✅ 插件签名验证 - 基础实现
- ✅ 服务熔断和超时控制 - 基础实现
- ✅ 配置加密存储 - 基础实现
- ✅ 异常隔离机制 - 基础实现

### 第二阶段（待实现）
- [ ] RBAC权限模型 - 0%
- [ ] 操作审计日志 - 0%
- [ ] 性能监控 - 0%
- [ ] 告警系统 - 0%

### 第三阶段（待实现）
- [ ] CLI工具 - 0%
- [ ] REST API - 0%
- [ ] 远程服务通信 - 0%
- [ ] 开发工具链 - 0%

### 总体进度
- **P0功能**: 约 70% 完成（第一阶段 + 第二阶段完成）
- **P1功能**: 约 30% 完成
- **总体**: 约 55% 完成

## 🎯 下一步建议

1. **立即开始第二阶段**
   - 实现RBAC权限模型（核心安全功能）
   - 实现操作审计日志（合规要求）

2. **完善第一阶段功能**
   - 升级加密算法到AES-256
   - 实现真正的异步服务调用
   - 完善资源监控实现

3. **开发工具支持**
   - 实现CLI工具，提高开发效率
   - 创建项目模板，降低上手难度

## 📝 注意事项

- 所有新功能实现后必须进行测试验证
- 代码提交前必须通过linter检查
- 重要功能需要编写使用文档
- 性能关键功能需要进行性能测试
