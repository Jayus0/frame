# 编译问题解决说明

## 问题描述

链接错误：`undefined reference to Eagle::Core::ApiServer::setFramework`

## 原因

库文件 `lib/libEagleCore.so` 是旧的，没有包含新添加的 `ApiServer` 和 `ApiRoutes` 代码。

## 解决方案

### 方法1：在Qt Creator中清理并重新编译

1. **清理项目**
   - 在Qt Creator中：`构建` → `清理项目 "EagleFramework"`
   - 或者右键项目 → `清理`

2. **重新运行qmake**
   - `构建` → `运行qmake`

3. **重新编译**
   - `构建` → `构建项目 "EagleFramework"`

### 方法2：命令行清理并重新编译

```bash
cd ~/sunt_ws/test/frame/frame

# 清理旧的构建文件
rm -rf build/core/obj/*ApiServer*
rm -rf build/core/obj/*ApiRoutes*
rm -rf build/core/moc/moc_ApiServer.cpp
rm -f lib/libEagleCore.so

# 进入构建目录（如果使用qmake）
cd ../build-EagleFramework-unknown_0994e9-Debug/core
make clean
make

# 或者重新运行qmake
cd ~/sunt_ws/test/frame/frame
qmake EagleFramework.pro
make
```

### 方法3：完全清理并重新构建

```bash
cd ~/sunt_ws/test/frame/frame

# 删除所有构建文件
rm -rf build/
rm -rf ../build-EagleFramework-*

# 删除库文件
rm -f lib/libEagleCore.so

# 重新运行qmake
qmake EagleFramework.pro

# 重新编译
make
```

## 验证

编译完成后，检查库文件是否包含新符号：

```bash
# 检查ApiServer相关符号
nm -D lib/libEagleCore.so | grep -i "ApiServer"
objdump -T lib/libEagleCore.so | grep -i "setFramework"
```

如果能看到相关符号，说明编译成功。

## 注意事项

1. **确保.pro文件已更新**
   - 检查 `core/core.pro` 中是否包含 `ApiServer.cpp` 和 `ApiRoutes.cpp`
   - 检查是否包含 `ApiServer.h` 和 `ApiRoutes.h`

2. **moc文件生成**
   - `ApiServer` 类包含 `Q_OBJECT` 宏，qmake会自动生成 `moc_ApiServer.cpp`
   - 如果moc文件没有生成，运行 `qmake` 重新生成

3. **路径问题**
   - 确保从正确的目录运行qmake（项目根目录）
   - 确保相对路径正确（`../src/core/...` 和 `../include/...`）

## 如果问题仍然存在

1. 检查 `core/core.pro` 文件是否正确
2. 检查源文件是否存在：`src/core/ApiServer.cpp` 和 `src/core/ApiRoutes.cpp`
3. 检查头文件是否存在：`include/eagle/core/ApiServer.h` 和 `include/eagle/core/ApiRoutes.h`
4. 查看编译输出，确认 `ApiServer.cpp` 和 `ApiRoutes.cpp` 是否被编译
5. 检查是否有编译错误（不仅仅是链接错误）
